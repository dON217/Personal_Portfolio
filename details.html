<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>project name - kevin cabranes</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="topdownstyle.css">
</head>
<script>
function getProjectParam() {
    const params = new URLSearchParams(window.location.search);
    return params.get('project') || 'branchingDialogue'; // default project
}

async function loadProjectDetails() {
    const project = getProjectParam();
    const jsonFile = `project-${project}.json`;

    try {
        const response = await fetch(jsonFile);
        const data = await response.json();

        // Project header
        document.querySelector('.project-name').textContent = data.name || '';
        document.querySelector('.project-tagline').textContent = data.tagline || '';
        if(document.querySelector('.project-role')) {
            document.querySelector('.project-role').textContent = data.role || '';
        }
        if(document.querySelector('.project-year')) {
            document.querySelector('.project-year').textContent = data.year || '';
        }
        document.title = `${data.name || 'project'} - kevin cabranes`;

        // Overview
        document.querySelector('.content-grid').innerHTML = `
            <div class="content-text">
                ${(data.overview || []).map(p => `<p>${p}</p>`).join('')}
            </div>
            <div class="content-info">
                <div class="info-block">
                    <h3>role</h3>
                    <p>${data.info?.role || ''}</p>
                </div>
                <div class="info-block">
                    <h3>technologies</h3>
                    <p>${data.info?.technologies || ''}</p>
                </div>
                ${data.info?.duration ? `
                <div class="info-block">
                    <h3>duration</h3>
                    <p>${data.info.duration}</p>
                </div>
                ` : ''}
            </div>
        `;

        // Media section: YouTube embed if present, else fallback to video tag if mp4/webm present
        const video = data.demonstration?.video || {};
        let videoHtml = '';
        if (video.youtube) {
            // Accept both full YouTube URLs and just the video ID
            let youtubeSrc = video.youtube;
            if (!youtubeSrc.includes('youtube.com') && !youtubeSrc.includes('youtu.be')) {
                youtubeSrc = `https://www.youtube.com/embed/${youtubeSrc}`;
            }
            videoHtml = `
                <div class="video-wrapper">
                    <iframe width="560" height="315" src="${youtubeSrc}" 
                        title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen style="max-width:100%;"></iframe>
                    <div class="media-caption">${video.caption || ''}</div>
                </div>
            `;
        } else if (video.mp4 || video.webm) {
            videoHtml = `
                <div class="video-wrapper">
                    <video controls ${video.poster ? `poster="${video.poster}"` : ''} style="max-width:100%;height:auto;">
                        ${video.mp4 ? `<source src="${video.mp4}" type="video/mp4">` : ''}
                        ${video.webm ? `<source src="${video.webm}" type="video/webm">` : ''}
                        Your browser does not support the video tag.
                    </video>
                    <div class="media-caption">${video.caption || ''}</div>
                </div>
            `;
        }
        document.querySelector('.media-container').innerHTML = videoHtml;

        // Gallery
        document.querySelector('.image-gallery').innerHTML = (data.demonstration?.gallery || []).map(img => `
            <div class="gallery-item">
                <img src="${img.src}" alt="${img.alt}" loading="lazy">
                <div class="media-caption">${img.caption}</div>
            </div>
        `).join('');

        // Process
        document.querySelector('.process-content').innerHTML = (data.process || []).map(step => `
            <div class="process-step">
                ${step.title ? `<h3>${step.title}</h3>` : ''}
                <p>${step.text}</p>
            </div>
        `).join('');

        // Technical
        document.querySelector('.technical-content').innerHTML = (data.technical || []).map(tech => `
            <div class="tech-block">
                ${tech.title ? `<h3>${tech.title}</h3>` : ''}
                <p>${tech.text}</p>
            </div>
        `).join('');

        // Results
        document.querySelector('.results-content').innerHTML = (data.results || []).map(result => `
            <div class="result-item">
                ${result.title ? `<h3>${result.title}</h3>` : ''}
                <p>${result.text}</p>
            </div>
        `).join('');

        // Links
        document.querySelector('.links-container').innerHTML = (data.links || []).map(link => `
            <a href="${link.href}" class="project-link-large">${link.label}</a>
        `).join('');
    } catch (e) {
        document.querySelector('.project-content').innerHTML = "<p>Project details not found.</p>";
    }
}

document.addEventListener('DOMContentLoaded', loadProjectDetails);
</script>

<body>
    <!-- Corner Text -->
    <div class="corner-text corner-top-right">game designer</div>
    <div class="corner-text corner-bottom-left">florida - havana</div>

    <!-- Back Navigation -->
    <nav class="back-nav">
        <a href="index.html" class="back-link"> < </a>
    </nav>

    <!-- Project Header -->
    <header class="project-hero">
        <div class="project-hero-content">
            <h1 class="project-name"></h1>
            <div class="project-meta">
                <span class="project-role"></span>
                <span class="project-year"></span>
            </div>
            <p class="project-tagline"></p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="project-content">
        
        <!-- Overview Section -->
        <section class="content-section">
            <h2 class="section-title">overview</h2>
            <div class="content-grid"></div>
        </section>

        <!-- Media Section -->
        <section class="content-section">
            <h2 class="section-title">demonstration</h2>
            <div class="media-container"></div>
            <div class="image-gallery"></div>
        </section>

        <!-- Process Section -->
        <section class="content-section">
            <h2 class="section-title">development process</h2>
            <div class="process-content"></div>
        </section>

        <!-- Technical Details -->
        <section class="content-section">
            <h2 class="section-title">technical implementation</h2>
            <div class="technical-content"></div>
        </section>

        <!-- Results Section -->
        <section class="content-section">
            <h2 class="section-title">results & impact</h2>
            <div class="results-content"></div>
        </section>

        <!-- Links Section -->
        <section class="content-section">
            <h2 class="section-title">links & resources</h2>
            <div class="links-container"></div>
        </section>

    </main>
</body>